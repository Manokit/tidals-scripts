---
phase: 03-editor-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [utilities/src/main/java/utilities/loadout/ui/ItemSlot.java, utilities/src/main/java/utilities/loadout/ui/ItemSearch.java]
autonomous: true
---

<objective>
Create foundation UI components: ItemSlot for reusable slot rendering, ItemSearch for item autocomplete with sprites.

Purpose: These are the building blocks for all loadout grids - ItemSlot is used by Equipment/Inventory/Pouch grids, ItemSearch provides the item selection popup.
Output: Two reusable JavaFX components in utilities.loadout.ui package.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior phase outputs needed
@.planning/phases/01-data-model/01-01-SUMMARY.md
@.planning/phases/02-item-resolution/02-02-SUMMARY.md

# Source files to understand
@utilities/src/main/java/utilities/loadout/LoadoutItem.java
@utilities/src/main/java/utilities/items/ItemResolver.java
@utilities/src/main/java/utilities/items/SpriteCache.java
@TidalsGemCutter/src/main/java/main/ScriptUI.java
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create ItemSlot component</name>
  <files>utilities/src/main/java/utilities/loadout/ui/ItemSlot.java</files>
  <action>
Create a reusable JavaFX component that displays a single loadout slot.

Features:
- Extends javafx.scene.layout.StackPane for layered rendering
- Fixed 36x36 pixel size (standard OSRS slot)
- Dark background (#2B2B2B) with 1px border (#555555)
- Displays item sprite centered (use JavaFXUtils.getItemImageView or ItemResolver)
- Shows quantity badge in bottom-right corner (white text on semi-transparent black)
- Shows quantity mode indicator: "*" for UNLIMITED, ">" prefix for MINIMUM
- Hover effect: lighter border (#40E0D0)
- Click handler property (Consumer<ItemSlot> onClick)
- setItem(LoadoutItem item, ScriptCore core) method to update display
- clearItem() method to show empty slot

Constructor takes ScriptCore for ItemManager/sprite access. Store reference to current LoadoutItem.

Follow existing ScriptUI.java styling patterns from TidalsGemCutter.
  </action>
  <verify>gradle :utilities:build compiles without errors</verify>
  <done>ItemSlot.java exists with setItem(), clearItem(), click handler, hover effects</done>
</task>

<task type="auto">
  <name>Task 2: Create ItemSearch component</name>
  <files>utilities/src/main/java/utilities/loadout/ui/ItemSearch.java</files>
  <action>
Create a JavaFX popup component for item selection with search and autocomplete.

Features:
- Extends javafx.scene.layout.VBox
- TextField at top for search input
- ListView below showing matching items (max 10 visible)
- Each list cell shows: sprite (16x16) + item name
- Filter items as user types (case-insensitive substring match)
- Use ItemResolver.getItemId() to validate and resolve item names
- Use ItemResolver.getName() to get display names
- Use JavaFXUtils.getItemImageView() for sprites in list cells
- Consumer<LoadoutItem> onItemSelected callback for selection
- Debounce search input (250ms delay before filtering)
- Pre-populate with common item IDs (can iterate 0-5000 for starter list)

Show method: showAsPopup(Stage owner, double x, double y) - displays as undecorated popup
Close on selection or click outside.

Build item list lazily on first show to avoid startup cost.
Match the ocean theme from existing ScriptUI: dark background (#0F3460), teal accents (#40E0D0).
  </action>
  <verify>gradle :utilities:build compiles without errors</verify>
  <done>ItemSearch.java exists with search field, filtered list, sprite display, selection callback</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd tidals-scripts && JAVA_HOME=$(/usr/libexec/java_home -v 17) gradle :utilities:build` succeeds
- [ ] Both files exist in utilities/src/main/java/utilities/loadout/ui/
- [ ] No compile errors or warnings
</verification>

<success_criteria>
- All tasks completed
- ItemSlot renders a slot with item sprite and quantity
- ItemSearch filters items and returns selection
- Components follow existing JavaFX patterns
</success_criteria>

<output>
After completion, create `.planning/phases/03-editor-ui/03-01-SUMMARY.md`
</output>
