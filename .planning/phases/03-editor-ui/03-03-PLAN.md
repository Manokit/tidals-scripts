---
phase: 03-editor-ui
plan: 03
type: execute
wave: 3
depends_on: ["03-01", "03-02"]
files_modified: [utilities/src/main/java/utilities/loadout/ui/PouchGrid.java, utilities/src/main/java/utilities/loadout/ui/LoadoutEditor.java]
autonomous: false
---

<objective>
Create pouch containers and main LoadoutEditor popup window integrating all components.

Purpose: Complete the visual loadout editor with rune/bolt pouch, quiver, and a launchable popup window.
Output: PouchGrid for pouch slots, LoadoutEditor as the main entry point for scripts.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Prior plan outputs
@.planning/phases/03-editor-ui/03-01-SUMMARY.md
@.planning/phases/03-editor-ui/03-02-SUMMARY.md

# Source files
@utilities/src/main/java/utilities/loadout/Loadout.java
@utilities/src/main/java/utilities/loadout/ui/ItemSlot.java
@utilities/src/main/java/utilities/loadout/ui/EquipmentGrid.java
@utilities/src/main/java/utilities/loadout/ui/InventoryGrid.java
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create PouchGrid component</name>
  <files>utilities/src/main/java/utilities/loadout/ui/PouchGrid.java</files>
  <action>
Create a reusable JavaFX component for rune pouch (4 slots), bolt pouch (4 slots), and quiver (1 slot).

Features:
- Extends javafx.scene.layout.VBox
- Constructor takes: String title, int slotCount, ScriptCore core
- Title label at top (teal text, e.g., "Rune Pouch")
- HBox below with slotCount ItemSlot instances in a row
- setItems(LoadoutItem[] items, ScriptCore core) method
- Consumer<Integer> onSlotClick callback (passes slot index within pouch)
- Enable/disable toggle (disabled pouches grayed out)
- CheckBox to enable/disable the pouch (default unchecked)

Usage:
- Rune Pouch: new PouchGrid("Rune Pouch", 4, core)
- Bolt Pouch: new PouchGrid("Bolt Pouch", 4, core)
- Quiver: new PouchGrid("Quiver", 1, core)

Match ocean theme styling.
  </action>
  <verify>gradle :utilities:build compiles without errors</verify>
  <done>PouchGrid.java exists with configurable slot count, enable checkbox, title</done>
</task>

<task type="auto">
  <name>Task 2: Create LoadoutEditor main window</name>
  <files>utilities/src/main/java/utilities/loadout/ui/LoadoutEditor.java</files>
  <action>
Create the main LoadoutEditor popup window that scripts will launch.

Layout:
```
+------------------------------------------+
| Loadout Editor               [X] Close   |
+------------------------------------------+
|  [Equipment Grid]  |  [Inventory Grid]   |
|                    |                     |
|                    |                     |
+------------------------------------------+
| [Rune Pouch] [Bolt Pouch] [Quiver]       |
+------------------------------------------+
| [Save] [Cancel]                          |
+------------------------------------------+
```

Features:
- Extends javafx.scene.layout.BorderPane
- Constructor: LoadoutEditor(ScriptCore core, Loadout loadout)
- Top: Title bar with "Loadout Editor" label
- Center: HBox with EquipmentGrid (left) and InventoryGrid (right)
- Bottom: VBox with pouches row and buttons row
- Save button: copies edited data back to original Loadout, closes window
- Cancel button: closes without saving
- Static show method: LoadoutEditor.show(ScriptCore core, Loadout loadout) opens popup

Implementation:
- Create internal working copy of Loadout for editing
- Wire all grid click handlers to show ItemSearch popup
- On item selection: update working copy and refresh slot display
- Save copies working copy data back to original Loadout reference

Window size approximately 500x400 pixels.
Match ocean theme: dark gradient background, teal accents, coral buttons.
  </action>
  <verify>gradle :utilities:build compiles without errors</verify>
  <done>LoadoutEditor.java exists with show() method, equipment/inventory/pouch grids, save/cancel</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete LoadoutEditor popup window with equipment grid, inventory grid, and pouch sections</what-built>
  <how-to-verify>
    1. Create a simple test script that calls LoadoutEditor.show() with an empty Loadout
    2. Verify the popup opens with ocean theme styling
    3. Verify equipment slots are positioned like OSRS equipment screen
    4. Verify inventory shows 7x4 grid (28 slots)
    5. Verify clicking a slot opens item search
    6. Verify item selection updates the slot with sprite
    7. Verify Save and Cancel buttons close the window
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `cd tidals-scripts && JAVA_HOME=$(/usr/libexec/java_home -v 17) gradle :utilities:build` succeeds
- [ ] All 6 UI files exist in utilities/src/main/java/utilities/loadout/ui/
- [ ] No compile errors or warnings
- [ ] Visual verification passed
</verification>

<success_criteria>
- All tasks completed
- PouchGrid works for variable slot counts
- LoadoutEditor popup opens and allows slot editing
- Visual layout matches expected design
- Save/Cancel buttons work correctly
</success_criteria>

<output>
After completion, create `.planning/phases/03-editor-ui/03-03-SUMMARY.md`
</output>
